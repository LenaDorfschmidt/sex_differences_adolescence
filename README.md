# Sexually divergent development of depression-related brain networks during healthy human adolescence

[![DOI](https://zenodo.org/badge/275769664.svg)](https://zenodo.org/badge/latestdoi/275769664)

This repository contains the code for the main analyses of the manuscript "Sexually divergent development of depression-related brain networks during healthy human adolescence" by Lena Dorfschmidt, Richard A.I. Bethlehem, Jakob Seidlitz, František Váša, Simon R. White, Rafael Romero-Garcia, Manfred G. Kitzbichler, Athina Aruldass, Ian M. Goodyer, Peter Fonagy, Peter B. Jones, Raymond J. Dolan, the NSPN Consortium, Petra E. Vértes, and Edward T. Bullmore* (2020).

For details behind these analyses refer to the manuscript: https://doi.org/10.1101/2020.07.06.184473

# Data
The data used here was initially published by [Váša et al. (2020)](https://doi.org/10.6084/m9.figshare.11551602). Please cite them, when using these data. 

All data required to run these analyses can be found at: 

# Requirements
To run all analyses in this publication, you will additionally need to download the code published by [Váša et al. (2018)](https://github.com/frantisekvasa/rotate_parcellation) to estimate the spherical permutation p-values. Download the code here and place them in a folder `Scripts/external/`.

# How to Run
To run this code, download the required data. Most of the scripts read in ouputs from other scripts, so the order in which you run them is essential.

1. Run `maturational_index/maturational_index.R` to generate the result on *sex differences in adolescent brain maturational*. 
2. Run `mdd_decoding/mdd.comparison.R` to run the *co-location analyses with depression*.
3. To run the *enrichment analyses for cell-types, chromosomes and disorders*:
    1. Run `PLS1_stats.m` to run the PLS analysis using Allen Human Brain Atlas data.
    2. Run `PLS2_bootstrap.m` to bootstrap the obtained PLS weights. 
    3. Now you can run `gene_decoding/gene_enrichment.R` to run the enrichment analyses for cell-types, chromosomes and disorders.
5. Running `neurosynth/wordcloud.R` generates the wordcloud maps in manuscript. 
6. Finally, comparisons between the analyses streams are generated by `replication/repl_stats.R`.

